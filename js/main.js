var Player=function(){var n=1;return this.getRandomColor=function(){for(var n="0123456789ABCDEF".split(""),o="#",a=0;6>a;a++)o+=n[Math.floor(16*Math.random())];return o},function(o){this.id=n,this.name=null!==o&&""!==o&&"undefined"!==o?o:"Player "+n,this.color=getRandomColor(),n++}}(),Connect4=function(n){n=n||{};var o=6,a=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],l=[o-1,o-1,o-1,o-1,o-1,o-1,o-1],r=n.players||[new Player,new Player],i=r[0],t=[],e=!1,c={},d=function(n,o){return 0>n||n>6||0>o||o>5?-1:a[n][o]},u=function(n){player=i;var o=l[n];-1==o?f("move:end",{column:n,row:o,player:player,is_column_full:!0}):(a[n][o]=player.id,l[n]=o-1,f("move:end",{column:n,row:o,player:player,is_column_full:!1}),w(n,o,player)===!0&&(e=!0,f("game:win",{winningBlocks:t,winner:player})),s()&&(e=!0,f("game:draw",{})),e!==!0&&g())},s=function(){return-1==l[0]&&-1==l[1]&&-1==l[2]&&-1==l[3]&&-1==l[4]&&-1==l[5]&&-1==l[6]},w=function(n,o,a){var l,r,i,e,c,u,s,w=a.id,g=!1;for(s=1==w?2:1,l=0;3>=l;l++){for(i=0,e=0,c=0,u=0,winningBlocks={},winningBlocks.horizontal=[],winningBlocks.vertical=[],winningBlocks.diagonal_forward=[],winningBlocks.diagonal_backword=[],r=0;3>=r;r++)d(n-l+r,o)==w&&(i++,winningBlocks.horizontal.push([n-l+r,o])),d(n,o-l+r)==w&&(e++,winningBlocks.vertical.push([n,o-l+r])),d(n-l+r,o-l+r)==w&&(c++,winningBlocks.diagonal_forward.push([n-l+r,o-l+r])),d(n-r+l,o-l+r)==w&&(u++,winningBlocks.diagonal_backword.push([n-r+l,o-l+r]));4==i?(g=!0,t=winningBlocks.horizontal):4==e?(g=!0,t=winningBlocks.vertical):4==c?(g=!0,t=winningBlocks.diagonal_forward):4==u&&(g=!0,t=winningBlocks.diagonal_backword),g&&(4==winningBlocks.horizontal.length,4==winningBlocks.vertical.length,4==winningBlocks.diagonal_forward.length,winningBlocks.diagonal_backword.length>=4)}return g},g=function(){var n=r.indexOf(i)+1;n==r.length&&(n=0),i=r[n]},p=function(n,o){c[n]=c[n]||[],c[n].push(o)},f=function(n,o){!c[n]||c[n].length<1||c[n].forEach(function(n){n(o||{})})};return{setBlock:u,on:p}},Connect4Game=function(){var n=null,o=[],a=!1,l=6,r=7,i="body",t=0,e=0,c=0,d=function(){var n,o,a,d,u,s=$(i).width(),w=$(i).height();n=Math.min(s,w),o=n*l/r,a=(w-o)/2,d=n/r,u=o,e=c=d,t=a;for(var p=jQuery("<div/>",{id:"connect4_board","class":"board",style:"width:"+n+"px; height:"+o+"px;padding:"+a+"px 0;"}),f=0;r>f;f++){$column=jQuery("<div/>",{"class":"board__col","data-col":f,style:"width:"+d+"px; height:"+u+"px;"});for(var h=0;l>h;h++)$column.append(jQuery("<div/>",{"class":"board__col__block","data-col":f,"data-row":h,style:"width:"+e+"px; height:"+c+"px;"}));$column.click(g),p.append($column)}var m=jQuery("<div/>",{"class":"board__blocks-wrapper"});p.append(m),$(i).prepend(p)},u=function(){},s=function(){},w=function(){d(),u(),s()},g=function(o){a||n.setBlock($(o.target).attr("data-col"))},p=function(n){if(n.is_column_full)alert("Column Full");else{var o=jQuery("<div/>",{id:"block"+n.column+n.row,"class":"block",style:"width:"+(e-6)+"px;height:"+(c-6)+"px;background-color: "+n.player.color+";transform: translate("+(n.column*e+3)+"px,0)"});$(".board__blocks-wrapper").append(o),window.getComputedStyle(document.getElementById("block"+n.column+n.row)).transform,o.css("transform","translate("+(n.column*e+3)+"px,"+(n.row*e+3+t)+"px)")}},f=function(n){for(var o=0;o<n.length;o++)$("#block"+n[o][0]+n[o][1]).addClass("winning")},h=function(n){a=!0,f(n.winningBlocks),confirm(n.winner.name+" Win \nDo you want to play again?")&&location.reload()},m=function(n){a=!0,alert("Draw Game, Nobody Win"),location.reload()},k=function(a){a=a||{};for(var l=1;2>=l;l++){var r=prompt("Enter Player "+l+" name:");o.push(new Player(r))}n=new Connect4({players:o}),n.on("move:end",p),n.on("game:win",h),n.on("game:draw",m),w()};return{start:k}}();Connect4Game.start();