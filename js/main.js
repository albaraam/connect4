var Player=function(){var n=1;return this.getRandomColor=function(){for(var n="0123456789ABCDEF".split(""),t="#",e=0;6>e;e++)t+=n[Math.floor(16*Math.random())];return t},function(t){this.id=n,this.name=null!==t&&""!==t?t:"Player "+n,this.color=getRandomColor(),n++}}(),Connect4=function(n){return self=this,this.config=n,this.columns_number=7,this.rows_number=6,this.board=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],this.columns_last_row=[this.rows_number-1,this.rows_number-1,this.rows_number-1,this.rows_number-1,this.rows_number-1,this.rows_number-1,this.rows_number-1],this.players=n.players,this.currentPlayer=this.players[0],this.winner=null,this.winningBlocks=[],this.IS_GAMR_OVER=!1,this._events={},this._getBlock=function(n,t){return 0>n||n>6||0>t||t>5?-1:this.board[n][t]},this._setBlock=function(n){player=self.currentPlayer;var t=self.columns_last_row[n];-1==t?self._publish("move:end",{column:n,row:t,player:player,is_column_full:!0}):(self.board[n][t]=player.id,self.columns_last_row[n]=t-1,self._publish("move:end",{column:n,row:t,player:player,is_column_full:!1}),self._checkIfWin(n,t,player)===!0&&(self.IS_GAMR_OVER=!0,self._publish("game:win",{winningBlocks:self.winningBlocks,winner:player})),self._checkGameEnded()&&(self.IS_GAMR_OVER=!0,self._publish("game:draw",{})),self.IS_GAMR_OVER!==!0&&self._switchPlayer())},this._checkGameEnded=function(){return-1==self.columns_last_row[0]&&-1==self.columns_last_row[1]&&-1==self.columns_last_row[2]&&-1==self.columns_last_row[3]&&-1==self.columns_last_row[4]&&-1==self.columns_last_row[5]&&-1==self.columns_last_row[6]},this._checkIfWin=function(n,t,e){var o,l,s,r,i,a,c,h,_,u,d,f=e.id,p=!1;for(d=1==f?2:1,o=0;3>=o;o++){for(s=0,r=0,i=0,a=0,c=0,h=0,_=0,u=0,winningBlocks={},winningBlocks.horizontal=[],winningBlocks.vertical=[],winningBlocks.diagonal_right=[],winningBlocks.diagonal_left=[],l=0;3>=l;l++)self._getBlock(n-o+l,t)==f&&(s++,winningBlocks.horizontal.push([n-o+l,t])),self._getBlock(n,t-o+l)==f&&(r++,winningBlocks.vertical.push([n,t-o+l])),self._getBlock(n-o+l,t-o+l)==f&&(i++,winningBlocks.diagonal_right.push([n-o+l,t-o+l])),self._getBlock(n-l+o,t-o+l)==f&&(a++,winningBlocks.diagonal_left.push([n-l+o,t-o+l]));s>=4&&0===c?p=!0:r>=4&&0===h?p=!0:i>=4&&0===_?p=!0:a>=4&&0===u&&(p=!0)}return p&&(winningBlocks.horizontal.length>=4&&(self.winningBlocks=winningBlocks.horizontal),winningBlocks.vertical.length>=4&&(self.winningBlocks=winningBlocks.vertical),winningBlocks.diagonal_right.length>=4&&(self.winningBlocks=winningBlocks.diagonal_right),winningBlocks.diagonal_left.length>=4&&(self.winningBlocks=winningBlocks.diagonal_left)),p},this._switchPlayer=function(){var n=self.players.indexOf(self.currentPlayer)+1;n==self.players.length&&(n=0),self.currentPlayer=self.players[n]},this.on=function(n,t){self._events[n]=self._events[n]||[],self._events[n].push(t)},this._publish=function(n,t){!self._events[n]||self._events[n].length<1||self._events[n].forEach(function(n){n(t||{})})},this.getCurrentPlayer=function(){return self.currentPlayer},{setBlock:this._setBlock,on:this.on,getCurrentPlayer:this.getCurrentPlayer}},Connect4Game=function(){return that=this,this._connect4=null,this._players=[],this._board_rows_number=6,this._board_columns_number=7,this._board_selector="body",this._boardMargin=0,this._blockWidth=0,this._blockHeight=0,this._renderBoard=function(){var n,t,e,o=$(this._board_selector).width(),l=$(this._board_selector).height();n=Math.min(o,l),t=n*this._board_rows_number/this._board_columns_number,e=(l-t)/2,columnWidth=n/this._board_columns_number,columnHeight=t,this._blockWidth=this._blockHeight=columnWidth,this._boardMargin=e,$board=jQuery("<div/>",{id:"connect4_board","class":"board",style:"width:"+n+"px; height:"+t+"px;padding:"+e+"px 0;"});for(var s=0;s<this._board_columns_number;s++){$column=jQuery("<div/>",{"class":"board__col","data-col":s,style:"width:"+columnWidth+"px; height:"+columnHeight+"px;"});for(var r=0;r<this._board_rows_number;r++)$column.append(jQuery("<div/>",{"class":"board__col__block","data-col":s,"data-row":r,style:"width:"+this._blockWidth+"px; height:"+this._blockHeight+"px;"}));$column.click(that._dropBlock),$board.append($column)}$blocksWrapper=jQuery("<div/>",{"class":"board__blocks-wrapper"}),$board.append($blocksWrapper),$(this._board_selector).prepend($board)},this._renderPlayers=function(){},this._renderPopup=function(){},this._render=function(){this._renderBoard(),this._renderPlayers(),this._renderPopup()},this._dropBlock=function(n){that._connect4.setBlock($(n.toElement).attr("data-col"))},this._renderBlock=function(n){if(n.is_column_full)alert("Column Full");else{var t=jQuery("<div/>",{id:"block"+n.column+n.row,"class":"block",style:"width:"+(that._blockWidth-6)+"px;height:"+(that._blockHeight-6)+"px;background-color: "+n.player.color+";transform: translate("+(n.column*that._blockWidth+3)+"px,0)"});$(".board__blocks-wrapper").append(t),window.getComputedStyle(document.getElementById("block"+n.column+n.row)).transform,t.css("transform","translate("+(n.column*that._blockWidth+3)+"px,"+(n.row*that._blockWidth+3+that._boardMargin)+"px)")}},this._showWinPopup=function(n){alert(n.winner.name+" Win"),location.reload()},this._showDrawPopup=function(n){alert("Draw Game, Nobody Win"),location.reload()},this._showPopup=function(n,t){},this.start=function(n){n=n||{};for(var t=1;2>=t;t++){var e=prompt("Enter Player "+t+" name:");that._players.push(new Player(e))}that._connect4=new Connect4({players:that._players}),that._connect4.on("move:end",that._renderBlock),that._connect4.on("game:win",that._showWinPopup),that._connect4.on("game:draw",that._showDrawPopup),that._render()},{start:that.start}}();Connect4Game.start();